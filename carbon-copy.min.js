(function(){const p='c-c-',cg=p+'get-',cgp=cg+'props-',ic=p+'initial-child',hs=p+'href-stamp';class CC extends HTMLElement{static get observedAttributes(){return['href','composed','get','set','get-props','set-props','stamp-href']}absolute(a,b){var c=a.split('/'),d=b.split('/');c.pop();for(var f=0;f<d.length;f++)'.'!=d[f]&&('..'==d[f]?c.pop():c.push(d[f]));return c.join('/')}append(a,b){const f=a.getElementById(b),g=document.importNode(f.content,!0);if(this._stampHref){const h=this.querySelectorAll('['+ic+']');for(let k=0,l=h.length;k<l;k++)h[k].style.display='none';const j=g.children;for(let k=0,l=j.length;k<l;k++){const m=j[k];m.setAttribute(hs,this._href)}}this.appendChild(g)}loadHref(){if(!this._initialized){if(this._stampHref){const a=this.children;for(let b=0,c=a.length-1;b<c;b++)a[b].setAttribute(ic,'true')}this._initialized=!0}if(this._href){let needToProcessFurther=!0;if(this._stampHref){const a=this.querySelectorAll(':scope > ['+hs+']');for(let b=0,c=a.length;b<c;b++){const d=a[b];d.getAttribute(hs)===this._href?(needToProcessFurther=!1,d.style.display=d.c_c_originalStyle):(d.c_c_originalStyle=d.style.display,d.style.display='none')}}if(needToProcessFurther){const splitHref=this._href.split('#');if(!(2>splitHref.length)){const url=splitHref[0],id=splitHref[1];if(0===url.length)return void this.append(document,id,null,url);const isAbsTests=['https://','/','//','http://'];let isAbsolute=!1;for(let a=0,b=isAbsTests.length;a<b;a++)if(url.startsWith(isAbsTests[a])){this._absUrl=url,isAbsolute=!0;break}isAbsolute||(this._absUrl=this.absolute(location.href,url));const absUrl=this._absUrl;let shadowDOM=CC._shadowDoms[absUrl];if(shadowDOM)switch(typeof shadowDOM){case'boolean':const a=CC._shadowDomSubscribers,b=c=>{this.append(c,id,absUrl,url)};a[absUrl]?a[absUrl].push(b):a[absUrl]=[b];break;case'object':this.append(shadowDOM,id,absUrl,url);}else CC._shadowDoms[absUrl]=!0,fetch(absUrl).then(resp=>{resp.text().then(txt=>{const container=document.createElement('div');container.style.display='none',document.body.appendChild(container);const shadowRoot=container.attachShadow({mode:'open'});CC._shadowDoms[absUrl]=shadowRoot;const parser=new DOMParser;let docFrag=parser.parseFromString(txt,'text/html');if(docFrag.head){const metaProcessors=docFrag.head.querySelectorAll('meta[name="preprocessor"]');for(let i=0,ii=metaProcessors.length;i<ii;i++){const metaProcessorTag=metaProcessors[i],metaProcessorIdentifier=metaProcessorTag.getAttribute('content'),metaProcessor=eval(metaProcessorIdentifier);docFrag=metaProcessor(docFrag,this)}}shadowRoot.appendChild(docFrag.body),this.append(shadowRoot,id,absUrl,url);const subscribers=CC._shadowDomSubscribers[absUrl];subscribers&&(subscribers.forEach(a=>a(shadowRoot)),delete CC._shadowDomSubscribers[absUrl])})})}}}}connectedCallback(){if(this._set){const a=this._set.split(';');a.forEach(b=>{const c=b.split(':'),d=c[0],f=c[1];this.addEventListener(cg+d,g=>{g.detail.value=f;const h=this.getAttribute(d+'-props');if(h){const j=h.split(';');j.forEach(k=>{const l=k.split(':'),m=l[0],n=l[1],o=m.split('.');let q=g.srcElement;const r=o.length;for(let t=0;t<r-1;t++)q=q[o[t]];const s=o[r-1];switch(typeof q[s]){case'string':q[s]=n;break;default:throw'not implemented yet';}})}})})}if(this._set_props){const a=this._set_props.split(';');a.forEach(b=>{this.addEventListener(cgp+b,c=>{c.detail.value=this[b];const d=c.srcElement.nextElementSibling;Object.defineProperty(this,b,{enumerable:!0,configurable:!0,set:function(g){d[b]=g}})})})}if(this._get){const a=new CustomEvent(cg+this._get,{detail:{},bubbles:!0,composed:this._composed});this.dispatchEvent(a),this.innerHTML=a.detail.value}if(this._get_props){const a=this._get_props.split(';');a.forEach(b=>{const c=new CustomEvent(cgp+b,{detail:{},bubbles:!0,composed:this._composed});this.dispatchEvent(c)})}this.loadHref()}attributeChangedCallback(a,b,c){'href'===a?(this._href=c,this._initialized&&this.loadHref()):'stamp-href'===a?this._stampHref=void 0!==c:'composed'===a?this._composed=null!==c:this['_'+a.replace('-','_')]=c}set href(a){this.setAttribute('href',a)}get href(){return this._href}}CC._shadowDoms={},CC._shadowDomSubscribers={};customElements.define('c-c',CC),customElements.define('carbon-copy',class extends CC{})})();